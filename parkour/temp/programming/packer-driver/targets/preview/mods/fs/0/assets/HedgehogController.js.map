{"version":3,"sources":["file:///D:/ProjectFiles/cocosCreater/NaughtyMonkey/parkour/assets/HedgehogController.ts"],"names":["Animation","_decorator","Component","find","RigidBody2D","v2","ccclass","property","HedgehogController","Number","moveway","ifrun","Math","random","ani","getComponent","rgd","run_possibility","node","getScale","x","linearVelocity","play","judgerun","y","getPosition","i","name","abs","position","bee_node","judge","reset","up_or_down","l_or_r","setScale","setPosition","console","log","start","ifup","up_possibility","update","deltaTime","during_time","judge_time","ifrevert","revert_possibility","getState","isPlaying","z","die"],"mappings":"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","sourcesContent":["\r\nimport { Animation,_decorator, Component, Node, find, RigidBody2D, v2, tween, v3 } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = HedgehogController\r\n * DateTime = Tue Mar 15 2022 09:20:12 GMT+0800 (中国标准时间)\r\n * Author = AlexiosLHB\r\n * FileBasename = HedgehogController.ts\r\n * FileBasenameNoExtension = HedgehogController\r\n * URL = db://assets/HedgehogController.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/zh/\r\n *\r\n */\r\n \r\n@ccclass('HedgehogController')\r\nexport class HedgehogController extends Component {\r\n    during_time:number=0;\r\n    @property(Number)\r\n    y:number\r\n    @property(Number)\r\n    judge_time:number;\r\n    @property(Number)\r\n    run_possibility:number;\r\n    @property(Number)\r\n    up_possibility:number;\r\n    @property(Number)\r\n    revert_possibility:number;\r\n   \r\n\r\n    \r\n    // [1]\r\n    // dummy = '';\r\n\r\n    // [2]\r\n    // @property\r\n    // serializableDummy = 0;\r\n    moveway(){\r\n        let ifrun = Math.random();\r\n        let ani = this.getComponent(Animation);\r\n        let rgd = this.getComponent(RigidBody2D);\r\n        if(ifrun<this.run_possibility){\r\n\r\n            if(this.node.getScale().x<0)\r\n            rgd.linearVelocity=v2(0,-18);\r\n            else  rgd.linearVelocity=v2(0,-12);\r\n            ani.play(\"Hedgehog_Walking\");\r\n\r\n        }\r\n        else{\r\n            rgd.linearVelocity=v2(0,-15);\r\n            ani.play(\"Hedgehog_Idle\");\r\n\r\n        }\r\n    }\r\n    judgerun(){\r\n        var y = this.node.getPosition().y;\r\n        for(var i =1;i<5;i++){\r\n            var node = find(\"Canvas/Hedgehog\"+i);\r\n            if(\"Hedgehog\"+i != this.node.name&&Math.abs(node.position.y-y)<=300)return false;\r\n        }\r\n        var bee_node = find(\"Canvas/Bee\");\r\n        if(Math.abs(bee_node.position.y-y)<=300)return false;\r\n        return true;\r\n    }\r\n    judge(){\r\n        for(var i =1;i<5;i++){\r\n            var node = find(\"Canvas/Hedgehog\"+i);\r\n            if(Math.abs(node.position.y-this.y)<=300)return false;\r\n        }\r\n        var bee_node = find(\"Canvas/Bee\");\r\n        if(Math.abs(bee_node.position.y-this.y)<=300)return false;\r\n        return true;\r\n    }\r\n    reset(){\r\n        let up_or_down = Math.random();\r\n\r\n        let l_or_r = Math.random();\r\n            if(l_or_r>0.5){\r\n                if(up_or_down<0.5){\r\n                this.node.setScale(-0.25,0.25,0.25);\r\n                }\r\n                else \r\n                {\r\n                    this.node.setScale(0.25,0.25,0.25);\r\n                }\r\n                this.node.setPosition(340,this.y,0);\r\n               \r\n\r\n            }\r\n            else{\r\n                if(up_or_down<0.5)\r\n                this.node.setScale(-0.25,-0.25,0.25);\r\n                else\r\n                this.node.setScale(0.25,-0.25,0.25);\r\n                this.node.setPosition(-326,this.y,0);\r\n            }\r\n            this.moveway();\r\n            console.log(\"set\");\r\n\r\n    }\r\n\r\n    start () {\r\n        let ifup = Math.random();\r\n        if(ifup<this.up_possibility){\r\n            this.reset();\r\n        }\r\n        else{\r\n            this.node.setPosition(340,-1000,0);\r\n        }\r\n        // [3]\r\n    }\r\n\r\n    update (deltaTime: number) {\r\n        this.during_time+=deltaTime;\r\n        //console.log(this.during_time);\r\n        if(this.during_time>this.judge_time&& this.node.getPosition().y<-870&&this.judge())\r\n        {\r\n            console.log(\"update!\");\r\n            this.during_time = 0;\r\n            let ifrevert = Math.random();\r\n            if(ifrevert<this.revert_possibility){\r\n                this.reset();\r\n            }\r\n        }\r\n        let ani = this.getComponent(Animation);\r\n        if(ani.getState(\"Hedgehog_Walking\").isPlaying == true){\r\n            if(this.judgerun()==false){\r\n                let rgd = this.getComponent(RigidBody2D);\r\n                if(rgd.linearVelocity.y==-18){\r\n                    this.node.setScale(0.25,this.node.getScale().y,this.node.getScale().z);\r\n                    rgd.linearVelocity = v2(0,-12);\r\n                }\r\n                else {\r\n                    this.node.setScale(-0.25,this.node.getScale().y,this.node.getScale().z);\r\n                    rgd.linearVelocity = v2(0,-18);\r\n\r\n                }\r\n            }\r\n        }\r\n        \r\n        // [4]\r\n    }\r\n\r\n    die() {\r\n        // this.node.getComponent(RigidBody2D).linearVelocity = v2(0,0);\r\n        this.node.getComponent(Animation).play('Hedgehog_Hurt');\r\n        // tween(this.node).to((this.node.position.y+871)/50,{position: v3(this.node.position.x,-871,0)})\r\n        // .start();\r\n\r\n    }\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/zh/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/zh/scripting/decorator.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/zh/scripting/life-cycle-callbacks.html\r\n */\r\n"]}